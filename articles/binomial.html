<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Binomial Outcomes • bayesCT</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Binomial Outcomes">
<meta property="og:description" content="bayesCT">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesCT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bayesCT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/binomial.html">Binomial Outcomes</a>
    </li>
    <li>
      <a href="../articles/normal.html">Continuous Outcomes</a>
    </li>
    <li>
      <a href="../articles/time-to-event.html">Time-to-Event Outcome</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/thevaachandereng/bayesCT/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Binomial Outcomes</h1>
                        <h4 class="author">Thevaa Chandereng, Donald Musgrove, Graeme L. Hickey</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/thevaachandereng/bayesCT/blob/master/vignettes/binomial.Rmd"><code>vignettes/binomial.Rmd</code></a></small>
      <div class="hidden name"><code>binomial.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The purpose of this vignette is to introduce how to simulate and analyze an adaptive Bayesian clinical trial for binomial outcomes. The simulation section compromises the design of the trial itself which provides type I error rate and power at each interim look. We use the beta-binomial conjugate prior for the estimation of posterior probabilities. Available historical data can be used as an informative prior; we use the <code>bayesDP</code> package as the engine for incorporating the historical data. By default, the model uses a non-informative prior of <span class="math inline">\(Beta(a = 1, b = 1)\)</span> with or without the incorporation of historical data. Instead of using traditional R function, we use pipes to input our parameters.</p>
</div>
<div id="estimation-of-treatment-difference" class="section level1">
<h1 class="hasAnchor">
<a href="#estimation-of-treatment-difference" class="anchor"></a>Estimation of treatment difference</h1>
<p>Let <span class="math inline">\(y\)</span> and <span class="math inline">\(N\)</span> denote the number of events and the sample size, respectively. Let <span class="math inline">\(a_0\)</span> and <span class="math inline">\(b_0\)</span> denote the rate parameters of a Beta distribution. Then, the posterior distribution of the event rate under vague (flat) prior distributions is</p>
<p><span class="math display">\[
\tilde{\theta}\mid y,N \; \sim \; \mathcal{B}eta\left(y+a_0,\,N-y+b_0 \right).
\]</span></p>
<p>When historical data is present, <span class="math inline">\(y_0\)</span> and <span class="math inline">\(N_0\)</span> denote the number of events and sample size of the historical data. The weight of the historical data included in the study design and analysis is denoted by <span class="math inline">\(\hat\alpha\)</span>. For more details on the computation of <span class="math inline">\(\hat{\alpha}\)</span>, please refer to the vignette of binomial counts available <a href="https://CRAN.R-project.org/package=bayesDP">here</a>. The posterior distribution of the event rate with historical data incorporated under vague (flat) prior distributions is</p>
<p><span class="math display">\[
\tilde{\theta} \mid y,N, y_0, N_0 \; \sim \; \mathcal{B}eta\left(y+y_0\hat{\alpha}+a_0,\, N-y+\hat{\alpha}(N_0-y_0)+b_0 \right),
\]</span></p>
<p>Since there is no closed-form solution for the difference in beta distributed random variables, we use Monte Carlo simulations to estimate the posterior of the treatment difference.</p>
<p>The estimation of the difference in proportions is <span class="math inline">\(\tilde{\theta}_T - \tilde{\theta}_C\)</span>, where <span class="math inline">\(\theta_T\)</span> is the posterior of the event rates in the treatment group and <span class="math inline">\(\theta_C\)</span> is the posterior of the event rates in the control group.</p>
<p>The following section lays out each of the functions and inputs for carrying out simulations and analyses of Bayesian adaptive trials.</p>
</div>
<div id="wrapper-function-for-design-and-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#wrapper-function-for-design-and-analysis" class="anchor"></a>Wrapper function for design and analysis</h1>
<p>Unlike traditional R functions, the <code>bayesCT</code> package depends on pipe inputs with different wrapper functions. The key wrapper functions are:</p>
<ul>
<li>
<code>binomial_outcome</code>: specifying event rates.</li>
<li>
<code>study_details</code>: specifying sample size, study length, interim looks, and loss to follow-up.</li>
<li>
<code>enrollment_rate</code>: specifying enrollment.</li>
<li>
<code>hypothesis</code>: specifying the hypothesis for both simulation and analysis.</li>
<li>
<code>randomize</code>: specifying the randomization scheme.</li>
<li>
<code>impute</code>: specifying imputation of outcomes at the interim looks.</li>
<li>
<code>beta_prior</code>: specifying the non-informative prior.</li>
<li>
<code>historical_binomial</code>: specifying historical data, if available. This function should only be used when historical data is incorporated in the analysis or simulation. For more details on the method and computation, please see <a href="https://CRAN.R-project.org/package=bayesDP" class="uri">https://CRAN.R-project.org/package=bayesDP</a>.</li>
<li>
<code>data_binomial</code>: inputting data with a binomial outcome.</li>
<li>
<code>analysis</code>: analyzing a trial at an interim analysis.</li>
<li>
<code>simulate</code>: simulating trials. <strong>Note:</strong> should only be used as the terminal end of the pipe.</li>
</ul>
</div>
<div id="design-of-adaptive-trials" class="section level1">
<h1 class="hasAnchor">
<a href="#design-of-adaptive-trials" class="anchor"></a>Design of adaptive trials</h1>
<p>In the following section, we will discuss the design of adaptive trials using <code>bayesCT</code> for binomial outcomes. We illustrate an example for one-arm trial and two-arm trials using the wrapper functions described above.</p>
<div id="one-arm-trial" class="section level2">
<h2 class="hasAnchor">
<a href="#one-arm-trial" class="anchor"></a>One-arm trial</h2>
<p>In the example below, we will illustrate how to compute power, type 1 error, and other characteristics for an objective performance criterion (OPC) (or performance goal; PG) trial with an observed proportion of events and hypothesis described as follows,</p>
<p><span class="math display">\[
H_0: \theta_{treatment} \geq 0.08 \qquad H_A:\theta_{treatment} &lt; 0.08.
\]</span></p>
<p>The most important wrapper functions are <code>study_details</code> and <code>binomial_outcome</code> (especially since there are no default values).</p>
<p>Binomial events are simulated using an event rate of 0.08. The total sample size is 900 with a study length of 50 days. A 10% loss to follow-up as assumed. Based on this information, the adaptive trials are simulated 2 times to obtain the following output (<strong>Note:</strong>: for the purpose of generating the vignette quickly, we reduce the number of simulations to 5, you should use a much larger value, e.g., 10,000). The aforementioned inputs were chosen for illustration purposes only.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">value</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/binomial_outcome.html">binomial_outcome</a></span>(<span class="kw">p_treatment</span> <span class="kw">=</span> <span class="fl">0.08</span>) <span class="kw">%&gt;%</span>
   <span class="fu"><a href="../reference/study_details.html">study_details</a></span>(<span class="kw">total_sample_size</span>     <span class="kw">=</span> <span class="fl">900</span>,
                 <span class="kw">study_period</span>          <span class="kw">=</span> <span class="fl">50</span>,
                 <span class="kw">interim_look</span>          <span class="kw">=</span> <span class="kw">NULL</span>,
                 <span class="kw">prop_loss_to_followup</span> <span class="kw">=</span> <span class="fl">0.10</span>)

<span class="co"># Simulate 2 trials</span>
<span class="no">output</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/simulate.html">simulate</a></span>(<span class="kw">no_of_sim</span> <span class="kw">=</span> <span class="fl">2</span>)

<span class="co"># Structure of the simulation output</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">output</span>)
<span class="co">#&gt; List of 8</span>
<span class="co">#&gt;  $ input                       :List of 4</span>
<span class="co">#&gt;   ..$ p_treatment          : num 0.08</span>
<span class="co">#&gt;   ..$ N_total              : num 900</span>
<span class="co">#&gt;   ..$ EndofStudy           : num 50</span>
<span class="co">#&gt;   ..$ prop_loss_to_followup: num 0.1</span>
<span class="co">#&gt;  $ power                       :'data.frame':    1 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ interim_looks: num 900</span>
<span class="co">#&gt;   ..$ power        : num 0</span>
<span class="co">#&gt;  $ type1_error                 : num 0.5</span>
<span class="co">#&gt;  $ est_final                   : num [1:2] 0.0813 0.0863</span>
<span class="co">#&gt;  $ post_prob_accept_alternative: num [1:2] 0.542 0.727</span>
<span class="co">#&gt;  $ N_enrolled                  : num [1:2] 900 900</span>
<span class="co">#&gt;  $ stop_expect_success         : num [1:2] 0 0</span>
<span class="co">#&gt;  $ stop_futility               : num [1:2] 0 0</span></pre></body></html></div>
<p>To allow for early stopping for success or futility, we can add interim looks to the design. We’ll check for success or futility at the enrollment of the 600-th, 700-th and 800-th subject. Upon adding this interim look requirement, the trial is simulated 2 times to obtain the output.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># Adding interim looks</span>
<span class="no">value</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/study_details.html">study_details</a></span>(<span class="kw">total_sample_size</span>     <span class="kw">=</span> <span class="fl">900</span>,
                <span class="kw">study_period</span>          <span class="kw">=</span> <span class="fl">50</span>,
                <span class="kw">interim_look</span>          <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">600</span>, <span class="fl">700</span>, <span class="fl">800</span>),
                <span class="kw">prop_loss_to_followup</span> <span class="kw">=</span> <span class="fl">0.10</span>)

<span class="co"># Simulate 2 trials</span>
<span class="no">output</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/simulate.html">simulate</a></span>(<span class="kw">no_of_sim</span> <span class="kw">=</span> <span class="fl">2</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">output</span>)
<span class="co">#&gt; List of 8</span>
<span class="co">#&gt;  $ input                       :List of 5</span>
<span class="co">#&gt;   ..$ p_treatment          : num 0.08</span>
<span class="co">#&gt;   ..$ N_total              : num 900</span>
<span class="co">#&gt;   ..$ EndofStudy           : num 50</span>
<span class="co">#&gt;   ..$ prop_loss_to_followup: num 0.1</span>
<span class="co">#&gt;   ..$ interim_look         : num [1:3] 600 700 800</span>
<span class="co">#&gt;  $ power                       :'data.frame':    4 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ interim_looks: num [1:4] 600 700 800 900</span>
<span class="co">#&gt;   ..$ power        : num [1:4] 0 0 0 0</span>
<span class="co">#&gt;  $ type1_error                 : num 0.5</span>
<span class="co">#&gt;  $ est_final                   : num [1:2] 0.0845 0.073</span>
<span class="co">#&gt;  $ post_prob_accept_alternative: num [1:2] 0.642 0.242</span>
<span class="co">#&gt;  $ N_enrolled                  : num [1:2] 700 700</span>
<span class="co">#&gt;  $ stop_expect_success         : num [1:2] 0 0</span>
<span class="co">#&gt;  $ stop_futility               : num [1:2] 1 1</span></pre></body></html></div>
<p>Patient enrollment is assumed to follow a Poisson process. The default enrollment rate is 0.3 patients per day. In this simulation we’ll introduce a step-wise Poisson process with rate <span class="math inline">\(\lambda\)</span> as follows:</p>
<p><span class="math display">\[
\lambda = \left\{
\begin{array}{ll}
      0.3 &amp; \text{time} \in [0, 25) \\
      1 &amp; \text{time} \in [25, \infty) \\
\end{array} 
\right.
\]</span></p>
<p>This enrollment scheme is illustrated below.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">value</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/enrollment_rate.html">enrollment_rate</a></span>(<span class="kw">lambda</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.3</span>, <span class="fl">1</span>),
                  <span class="kw">time</span>   <span class="kw">=</span> <span class="fl">25</span>)

<span class="no">output</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/simulate.html">simulate</a></span>(<span class="kw">no_of_sim</span> <span class="kw">=</span> <span class="fl">2</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">output</span>)
<span class="co">#&gt; List of 8</span>
<span class="co">#&gt;  $ input                       :List of 7</span>
<span class="co">#&gt;   ..$ p_treatment          : num 0.08</span>
<span class="co">#&gt;   ..$ N_total              : num 900</span>
<span class="co">#&gt;   ..$ EndofStudy           : num 50</span>
<span class="co">#&gt;   ..$ prop_loss_to_followup: num 0.1</span>
<span class="co">#&gt;   ..$ interim_look         : num [1:3] 600 700 800</span>
<span class="co">#&gt;   ..$ lambda               : num [1:2] 0.3 1</span>
<span class="co">#&gt;   ..$ lambda_time          : num 25</span>
<span class="co">#&gt;  $ power                       :'data.frame':    4 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ interim_looks: num [1:4] 600 700 800 900</span>
<span class="co">#&gt;   ..$ power        : num [1:4] 0 0 0 0</span>
<span class="co">#&gt;  $ type1_error                 : num 0</span>
<span class="co">#&gt;  $ est_final                   : num [1:2] 0.0847 0.0758</span>
<span class="co">#&gt;  $ post_prob_accept_alternative: num [1:2] 0.64 0.342</span>
<span class="co">#&gt;  $ N_enrolled                  : num [1:2] 600 600</span>
<span class="co">#&gt;  $ stop_expect_success         : num [1:2] 0 0</span>
<span class="co">#&gt;  $ stop_futility               : num [1:2] 1 1</span></pre></body></html></div>
<p>The hypothesis is an important wrapper function which controls the probability of futility, probability of accepting the alternative hypothesis, probability of early success, the alternative hypothesis, and the treatment difference margin.</p>
<p>Since, in an OPC trial, the proportion of events in the treatment group are simulated using the input provided, <code>delta</code> controls the maximum threshold allowed for the trial to succeed/fail. The default value of <code>delta</code> is 0. Here, we’ll use <code>delta = -0.03</code> (i.e. <span class="math inline">\(\hat\theta_{treatment} - 0.08 &gt; -0.03\)</span>).</p>
<p>We’ll further set the futility probability to 0.05, the expected success probability for early stopping to 0.90, and the final probability of accepting the alternative to 0.95. The alternative is <code>"less"</code> due to the hypothesis function specified above.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">value</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/hypothesis.html">hypothesis</a></span>(<span class="kw">delta</span>                 <span class="kw">=</span> -<span class="fl">0.03</span>,
             <span class="kw">futility_prob</span>         <span class="kw">=</span> <span class="fl">0.05</span>,
                   <span class="kw">prob_accept_ha</span>        <span class="kw">=</span> <span class="fl">0.95</span>,
             <span class="kw">expected_success_prob</span> <span class="kw">=</span> <span class="fl">0.90</span>,
                   <span class="kw">alternative</span>           <span class="kw">=</span> <span class="st">"less"</span>)

<span class="no">output</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/simulate.html">simulate</a></span>(<span class="kw">no_of_sim</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p>Next, we’ll illustrate imputations for imputing outcomes for subjects loss to follow up. We’ll carry out 5 imputations and draw 1000 values from the posterior of each imputation.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">value</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/impute.html">impute</a></span>(<span class="kw">no_of_impute</span> <span class="kw">=</span> <span class="fl">5</span>,
         <span class="kw">number_mcmc</span>  <span class="kw">=</span> <span class="fl">1000</span>)

<span class="no">output</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/simulate.html">simulate</a></span>(<span class="kw">no_of_sim</span> <span class="kw">=</span> <span class="fl">10</span>)</pre></body></html></div>
<p>The default non-informative beta prior used in the simulation is <span class="math inline">\(\mathcal{B}eta(1, 1)\)</span>. In our OPC trial simulation, we’ll change the default to <span class="math inline">\(\mathcal{B}eta(5, 5)\)</span>. This will increase the weight of the non-informative prior in the simulation. This non-informative beta prior is implemented using beta_prior wrapper function.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">value</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/beta_prior.html">beta_prior</a></span>(<span class="kw">a0</span> <span class="kw">=</span> <span class="fl">5</span>,
             <span class="kw">b0</span> <span class="kw">=</span> <span class="fl">5</span>)

<span class="no">output</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/simulate.html">simulate</a></span>(<span class="kw">no_of_sim</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p>Historical data is not required to compute the simulation. However, if historical data is available, it can be incorporated into the analysis using the discount prior approach as implemented in the <code>bayesDP</code> R package.</p>
<p>In our OPC trial, we’ll illustrate historical data incorporation. We’ll assume that the historical data had 5 events in 55 subjects. We’ll incorporate this historical data using the identity discount function.</p>
<p>For more details on the historical data incorporation method and computation, please see <a href="https://CRAN.R-project.org/package=bayesDP" class="uri">https://CRAN.R-project.org/package=bayesDP</a>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">value</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/historical_binomial.html">historical_binomial</a></span>(<span class="kw">y0_treatment</span>      <span class="kw">=</span> <span class="fl">5</span>,
                      <span class="kw">N0_treatment</span>      <span class="kw">=</span> <span class="fl">55</span>,
                      <span class="kw">discount_function</span> <span class="kw">=</span> <span class="st">"identity"</span>,
                      <span class="kw">y0_control</span>        <span class="kw">=</span> <span class="kw">NULL</span>,
                      <span class="kw">N0_control</span>        <span class="kw">=</span> <span class="kw">NULL</span>,
                      <span class="kw">alpha_max</span>         <span class="kw">=</span> <span class="fl">1</span>,
                      <span class="kw">fix_alpha</span>         <span class="kw">=</span> <span class="fl">FALSE</span>,
                      <span class="kw">weibull_scale</span>     <span class="kw">=</span> <span class="fl">0.135</span>,
                      <span class="kw">weibull_shape</span>     <span class="kw">=</span> <span class="fl">3</span>,
                      <span class="kw">method</span>            <span class="kw">=</span> <span class="st">"fixed"</span>)

<span class="no">output</span> <span class="kw">&lt;-</span> <span class="no">value</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/simulate.html">simulate</a></span>(<span class="kw">no_of_sim</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p>The above flow was for illustrative purposes. Instead of inputting parameters step by step, the trial parameters can be filled in all at once as illustrated below. The pipe function connects all inputs together and the trial is simulated 2 times to obtain results.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">value</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/binomial_outcome.html">binomial_outcome</a></span>(<span class="kw">p_treatment</span> <span class="kw">=</span> <span class="fl">0.08</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/enrollment_rate.html">enrollment_rate</a></span>(<span class="kw">lambda</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.3</span>, <span class="fl">1</span>),
                  <span class="kw">time</span>   <span class="kw">=</span> <span class="fl">25</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/study_details.html">study_details</a></span>(<span class="kw">total_sample_size</span>     <span class="kw">=</span> <span class="fl">900</span>,
                <span class="kw">study_period</span>          <span class="kw">=</span> <span class="fl">50</span>,
                <span class="kw">interim_look</span>          <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">600</span>, <span class="fl">700</span>, <span class="fl">800</span>),
                <span class="kw">prop_loss_to_followup</span> <span class="kw">=</span> <span class="fl">0.10</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/hypothesis.html">hypothesis</a></span>(<span class="kw">delta</span>                 <span class="kw">=</span> -<span class="fl">0.03</span>,
             <span class="kw">futility_prob</span>         <span class="kw">=</span> <span class="fl">0.05</span>,
                   <span class="kw">prob_accept_ha</span>        <span class="kw">=</span> <span class="fl">0.95</span>,
             <span class="kw">expected_success_prob</span> <span class="kw">=</span> <span class="fl">0.90</span>,
                   <span class="kw">alternative</span>           <span class="kw">=</span> <span class="st">"less"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/impute.html">impute</a></span>(<span class="kw">no_of_impute</span> <span class="kw">=</span> <span class="fl">25</span>,
         <span class="kw">number_mcmc</span>  <span class="kw">=</span> <span class="fl">1000</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/beta_prior.html">beta_prior</a></span>(<span class="kw">a0</span> <span class="kw">=</span> <span class="fl">5</span>,
             <span class="kw">b0</span> <span class="kw">=</span> <span class="fl">5</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/historical_binomial.html">historical_binomial</a></span>(<span class="kw">y0_treatment</span>      <span class="kw">=</span> <span class="fl">5</span>,
                      <span class="kw">N0_treatment</span>      <span class="kw">=</span> <span class="fl">55</span>,
                      <span class="kw">discount_function</span> <span class="kw">=</span> <span class="st">"identity"</span>,
                      <span class="kw">y0_control</span>        <span class="kw">=</span> <span class="kw">NULL</span>,
                                <span class="kw">N0_control</span>        <span class="kw">=</span> <span class="kw">NULL</span>,
                      <span class="kw">alpha_max</span>         <span class="kw">=</span> <span class="fl">1</span>,
                                <span class="kw">fix_alpha</span>         <span class="kw">=</span> <span class="fl">FALSE</span>,
                      <span class="kw">weibull_scale</span>     <span class="kw">=</span> <span class="fl">0.135</span>,
                                <span class="kw">weibull_shape</span>     <span class="kw">=</span> <span class="fl">3</span>,
                      <span class="kw">method</span>            <span class="kw">=</span> <span class="st">"fixed"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/simulate.html">simulate</a></span>(<span class="kw">no_of_sim</span> <span class="kw">=</span> <span class="fl">2</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">value</span>)
<span class="co">#&gt; List of 8</span>
<span class="co">#&gt;  $ input                       :List of 23</span>
<span class="co">#&gt;   ..$ p_treatment          : num 0.08</span>
<span class="co">#&gt;   ..$ lambda               : num [1:2] 0.3 1</span>
<span class="co">#&gt;   ..$ lambda_time          : num 25</span>
<span class="co">#&gt;   ..$ N_total              : num 900</span>
<span class="co">#&gt;   ..$ EndofStudy           : num 50</span>
<span class="co">#&gt;   ..$ interim_look         : num [1:3] 600 700 800</span>
<span class="co">#&gt;   ..$ prop_loss_to_followup: num 0.1</span>
<span class="co">#&gt;   ..$ h0                   : num -0.03</span>
<span class="co">#&gt;   ..$ futility_prob        : num 0.05</span>
<span class="co">#&gt;   ..$ prob_ha              : num 0.95</span>
<span class="co">#&gt;   ..$ expected_success_prob: num 0.9</span>
<span class="co">#&gt;   ..$ alternative          : chr "less"</span>
<span class="co">#&gt;   ..$ N_impute             : num 25</span>
<span class="co">#&gt;   ..$ number_mcmc          : num 1000</span>
<span class="co">#&gt;   ..$ prior                : num [1:2] 5 5</span>
<span class="co">#&gt;   ..$ y0_treatment         : num 5</span>
<span class="co">#&gt;   ..$ N0_treatment         : num 55</span>
<span class="co">#&gt;   ..$ discount_function    : chr "identity"</span>
<span class="co">#&gt;   ..$ alpha_max            : num 1</span>
<span class="co">#&gt;   ..$ fix_alpha            : logi FALSE</span>
<span class="co">#&gt;   ..$ weibull_scale        : num 0.135</span>
<span class="co">#&gt;   ..$ weibull_shape        : num 3</span>
<span class="co">#&gt;   ..$ method               : chr "fixed"</span>
<span class="co">#&gt;  $ power                       :'data.frame':    4 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ interim_looks: num [1:4] 600 700 800 900</span>
<span class="co">#&gt;   ..$ power        : num [1:4] 0 0.5 1 1</span>
<span class="co">#&gt;  $ type1_error                 : num 0</span>
<span class="co">#&gt;  $ est_final                   : num [1:2] 0.0861 0.0824</span>
<span class="co">#&gt;  $ post_prob_accept_alternative: num [1:2] 0.988 0.991</span>
<span class="co">#&gt;  $ N_enrolled                  : num [1:2] 800 700</span>
<span class="co">#&gt;  $ stop_expect_success         : num [1:2] 1 1</span>
<span class="co">#&gt;  $ stop_futility               : num [1:2] 0 0</span></pre></body></html></div>
</div>
<div id="two-arm-trial" class="section level2">
<h2 class="hasAnchor">
<a href="#two-arm-trial" class="anchor"></a>Two-arm trial</h2>
<p>In this section, we will illustrate how to perform the design of a two-arm trial without incorporating historical data. The example will compute the type 1 error, power, and other outputs for a superiority trial. The study hypothesis is</p>
<p><span class="math display">\[
H_0: \theta_{treatment} - \theta_{control} \leq 0 \qquad H_A: \theta_{treatment} - \theta_{control} &gt; 0.
\]</span></p>
<p>The binomial events are simulated using an event rate of 0.15 for the treatment group and 0.12 for the control group. The total sample size is 400, with a study length of 30 days. A 15% loss to follow up is assumed. Further, we will illustrate block randomization. The following code simulates a trial 2 times using the piping procedure.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r">
<span class="no">value</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/binomial_outcome.html">binomial_outcome</a></span>(<span class="kw">p_treatment</span> <span class="kw">=</span> <span class="fl">0.15</span>,
                          <span class="kw">p_control</span>   <span class="kw">=</span> <span class="fl">0.12</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/study_details.html">study_details</a></span>(<span class="kw">total_sample_size</span>     <span class="kw">=</span> <span class="fl">400</span>,
                <span class="kw">study_period</span>          <span class="kw">=</span> <span class="fl">30</span>,
                <span class="kw">interim_look</span>          <span class="kw">=</span> <span class="fl">350</span>,
                <span class="kw">prop_loss_to_followup</span> <span class="kw">=</span> <span class="fl">0.15</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/hypothesis.html">hypothesis</a></span>(<span class="kw">delta</span>                 <span class="kw">=</span> <span class="fl">0</span>,
             <span class="kw">futility_prob</span>         <span class="kw">=</span> <span class="fl">0.10</span>,
             <span class="kw">prob_accept_ha</span>        <span class="kw">=</span> <span class="fl">0.975</span>,
             <span class="kw">expected_success_prob</span> <span class="kw">=</span> <span class="fl">1</span>,
             <span class="kw">alternative</span>           <span class="kw">=</span> <span class="st">"greater"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/randomize.html">randomize</a></span>(<span class="kw">block_size</span>          <span class="kw">=</span> <span class="fl">9</span>,
            <span class="kw">randomization_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">5</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/impute.html">impute</a></span>(<span class="kw">no_of_impute</span> <span class="kw">=</span> <span class="fl">5</span>,
         <span class="kw">number_mcmc</span>  <span class="kw">=</span> <span class="fl">5000</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/beta_prior.html">beta_prior</a></span>(<span class="kw">a0</span> <span class="kw">=</span> <span class="fl">0</span>,
             <span class="kw">b0</span> <span class="kw">=</span> <span class="fl">0</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/simulate.html">simulate</a></span>(<span class="kw">no_of_sim</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
</div>
</div>
<div id="analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis" class="anchor"></a>Analysis</h1>
<p>In this section, we will demonstrate how to run an adaptive Bayesian trial using <code>bayesCT</code>. A sample dataset is provided in the package. The dataset <code>binomialdata</code> contains the results of 300 subjects from a two-arm trial with binomial outcome. The <code>complete</code> column indicates whether the outcome was observed, i.e. loss to follow-up.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">binomialdata</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">binomialdata</span>)
<span class="co">#&gt;         id treatment outcome complete</span>
<span class="co">#&gt; 1 Patient1         1       0        0</span>
<span class="co">#&gt; 2 Patient2         0       0        1</span>
<span class="co">#&gt; 3 Patient3         1       0        1</span>
<span class="co">#&gt; 4 Patient4         0       0        1</span>
<span class="co">#&gt; 5 Patient5         0       1        1</span>
<span class="co">#&gt; 6 Patient6         0       0        1</span></pre></body></html></div>
<p>The minimum input needed to run an adaptive Bayesian trial is the data itself. The <code>data_binomial</code> input allows the input of the data. The treatment group (0 for control, 1 for treatment) and outcome input are essential for the analysis. However, if the complete input is not provided, the function assumes the outcome data is complete. A default analysis is carried out below.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">input</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/data_binomial.html">data_binomial</a></span>(<span class="kw">treatment</span> <span class="kw">=</span> <span class="no">binomialdata</span>$<span class="no">treatment</span>,
                       <span class="kw">outcome</span>   <span class="kw">=</span> <span class="no">binomialdata</span>$<span class="no">outcome</span>,
                       <span class="kw">complete</span>  <span class="kw">=</span> <span class="no">binomialdata</span>$<span class="no">complete</span>)

<span class="no">out</span> <span class="kw">&lt;-</span> <span class="no">input</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/analysis.html">analysis</a></span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">"binomial"</span>)
<span class="co">#&gt; Are you at the final sample size? There is no opportunity to stop enrollment.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;             Consider setting N_max_treatment and/or N_max_control</span></pre></body></html></div>
<p>We’ll now illustrate using piping to carry out the complete analysis. First, we’ll assume the following hypothesis:</p>
<p><span class="math display">\[
H_0:\theta_{treatment} - \theta_{control} \le 0.02 \quad H_A: \theta_{treatment} - \theta_{control} &gt; 0.02
\]</span></p>
<p>The delta and alternative used to analyze the trial is 0.02 and “greater” respectively. The probability of accepting the alternative is 0.95, the probability of stopping for futility is 0.05, and the probability of stopping for success is 0.90. We will carry out imputations on subjects loss to follow up. Additionally, we will incorporate historical data on the treatment arm.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/data_binomial.html">data_binomial</a></span>(<span class="kw">treatment</span> <span class="kw">=</span> <span class="no">binomialdata</span>$<span class="no">treatment</span>,
                     <span class="kw">outcome</span>   <span class="kw">=</span> <span class="no">binomialdata</span>$<span class="no">outcome</span>,
                     <span class="kw">complete</span>  <span class="kw">=</span> <span class="no">binomialdata</span>$<span class="no">complete</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/hypothesis.html">hypothesis</a></span>(<span class="kw">delta</span>                 <span class="kw">=</span> <span class="fl">0.02</span>,
             <span class="kw">futility_prob</span>         <span class="kw">=</span> <span class="fl">0.05</span>,
                   <span class="kw">prob_accept_ha</span>        <span class="kw">=</span> <span class="fl">0.95</span>,
                   <span class="kw">expected_success_prob</span> <span class="kw">=</span> <span class="fl">0.90</span>,
                   <span class="kw">alternative</span>           <span class="kw">=</span> <span class="st">"greater"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/impute.html">impute</a></span>(<span class="kw">no_of_impute</span> <span class="kw">=</span> <span class="fl">50</span>,
         <span class="kw">number_mcmc</span>  <span class="kw">=</span> <span class="fl">10000</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/beta_prior.html">beta_prior</a></span>(<span class="kw">a0</span> <span class="kw">=</span> <span class="fl">3</span>,
             <span class="kw">b0</span> <span class="kw">=</span> <span class="fl">3</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/historical_binomial.html">historical_binomial</a></span>(<span class="kw">y0_treatment</span>      <span class="kw">=</span> <span class="fl">12</span>,
                      <span class="kw">N0_treatment</span>      <span class="kw">=</span> <span class="fl">100</span>,
                      <span class="kw">y0_control</span>        <span class="kw">=</span> <span class="kw">NULL</span>,
                                <span class="kw">N0_control</span>        <span class="kw">=</span> <span class="kw">NULL</span>,
                      <span class="kw">discount_function</span> <span class="kw">=</span> <span class="st">"weibull"</span>,
                      <span class="kw">alpha_max</span>         <span class="kw">=</span> <span class="fl">1</span>,
                                <span class="kw">fix_alpha</span>         <span class="kw">=</span> <span class="fl">FALSE</span>,
                      <span class="kw">weibull_scale</span>     <span class="kw">=</span> <span class="fl">0.135</span>,
                                <span class="kw">weibull_shape</span>     <span class="kw">=</span> <span class="fl">3</span>,
                      <span class="kw">method</span>            <span class="kw">=</span> <span class="st">"fixed"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/analysis.html">analysis</a></span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">"binomial"</span>)
<span class="co">#&gt; Are you at the final sample size? There is no opportunity to stop enrollment.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;             Consider setting N_max_treatment and/or N_max_control</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">out</span>)
<span class="co">#&gt; List of 13</span>
<span class="co">#&gt;  $ prob_of_accepting_alternative: num 0.95</span>
<span class="co">#&gt;  $ margin                       : num 0.02</span>
<span class="co">#&gt;  $ alternative                  : chr "greater"</span>
<span class="co">#&gt;  $ N_treatment                  : num 125</span>
<span class="co">#&gt;  $ N_control                    : int 137</span>
<span class="co">#&gt;  $ N_complete                   : num 262</span>
<span class="co">#&gt;  $ N_enrolled                   : int 300</span>
<span class="co">#&gt;  $ N_max_treatment              : int 140</span>
<span class="co">#&gt;  $ N_max_control                : int 160</span>
<span class="co">#&gt;  $ post_prob_accept_alternative : num 0.982</span>
<span class="co">#&gt;  $ est_final                    : num 0.12</span>
<span class="co">#&gt;  $ stop_futility                : num 0</span>
<span class="co">#&gt;  $ stop_expected_success        : num 1</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thevaa Chandereng, Donald Musgrove, Tarek Haddad, Graeme L. Hickey, Timothy Hanson, Theodore Lystig.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
